{%load static%}
{%load staticfiles %}

<!DOCTYPE html>
<html lang="en">
<head>

    <!-- Animate.css -->
    <link rel="stylesheet" href="{% static 'css/animate.css' %}">
    <!-- Icomoon Icon Fonts-->
    <link rel="stylesheet" href="{% static 'css/icomoon.css' %}">
    <!-- Bootstrap  -->
    <link rel="stylesheet" href="{% static 'css/bootstrap.css' %}">

    <!-- Flexslider  -->
    <link rel="stylesheet" href="{% static 'css/flexslider.css'%}">

    <!-- Owl Carousel  -->
    <link rel="stylesheet" href="{% static 'css/owl.carousel.min.css' %}">
    <link rel="stylesheet" href="{% static 'css/owl.theme.default.min.css' %}">

    <!-- Theme style  -->
    <link rel="stylesheet" href="{% static 'css/style.css' %}">

    <link rel="stylesheet" href="{% static 'css/aos.css' %}">

    <link rel="stylesheet" href="{% static 'css/bootstrap.min.css' %}">

    <link rel="stylesheet" href="{% static 'css/magnific-popup.css' %}">

    <link rel="stylesheet" href="{% static 'css/jquery-ui.css' %}">

    <script src="{% static 'js/client.js' %}"></script>

    <script src="{% static 'js/cookieMonster.js' %}"></script>

    <!-- Modernizr JS -->
    <script src="{% static 'js/modernizr-2.6.2.min.js' %}"></script>
    <!-- FOR IE9 below -->
    <!--[if lt IE 9]>
	<script src="{% static 'js/respond.min.js' %}"></script>
	<![endif]-->

    <style type="text/css">
        /* Full-width input fields */
        .notification {
          color: white;
          text-decoration: none;
          padding: 15px 26px;
          position: relative;
          border-radius: 2px;
        }
        .notification .badge {
          position: absolute;
          top: 15px;
          right: -7px;
          padding: 5px 7px;
          border-radius: 20%;
          background-color: red;
          color: white;
        }
        input[type=text], input[type=password] {
            width: 100%;
            padding: 12px 20px;
            margin: 8px 0;
            display: inline-block;
            border: 1px solid #ccc;
            box-sizing: border-box;
        }

        /* Set a style for all buttons */
        button {
            background-color: #4CAF50;
            color: white;
            padding: 14px 20px;
            margin: 8px 0;
            border: none;
            cursor: pointer;
            width: 100%;
        }

        button:hover {
            opacity: 0.8;
        }

        .log {
            display: none;
        }
        /* Extra styles for the cancel button */
        .cancelbtn {
            width: auto;
            padding: 10px 18px;
            background-color: #f44336;
        }

        /* Center the image and position the close button */
        .imgcontainer2 {
            text-align: center;
            margin: 24px 0 12px 0;
            position: relative;
        }

        img.avatar {
            width: 40%;
            border-radius: 50%;
        }

        .container_lg2 {
            padding: 16px;
            width: 100%;
        }

        span.psw {
            float: right;
            padding-top: 16px;
        }

        /* The Modal (background) */
        .modal2 {
            display: none; /* Hidden by default */
            position: fixed; /* Stay in place */
            z-index: 1; /* Sit on top */
            left: 0;
            top: 0;
            width: 100%; /* Full width */
            height: 100%; /* Full height */
            overflow: auto; /* Enable scroll if needed */
            background-color: rgb(0,0,0); /* Fallback color */
            background-color: rgba(0,0,0,0.4); /* Black w/ opacity */
            padding-top: 60px;
        }

        /* Modal Content/Box */
        .modal-content2 {
            background-color: #fefefe;
            margin: 5% auto 15% auto; /* 5% from the top, 15% from the bottom and centered */
            border: 1px solid #888;
            width: 40%; /* Could be more or less, depending on screen size */
        }

        /* The Close Button (x) */
        .close {
            position: absolute;
            right: 25px;
            top: 0;
            color: #000;
            font-size: 35px;
            font-weight: bold;
        }

        .close:hover,
        .close:focus {
            color: red;
            cursor: pointer;
        }

        /* Add Zoom Animation */
        .animate {
            -webkit-animation: animatezoom 0.6s;
            animation: animatezoom 0.6s
        }

        @-webkit-keyframes animatezoom {
            from {-webkit-transform: scale(0)}
            to {-webkit-transform: scale(1)}
        }

        @keyframes animatezoom {
            from {transform: scale(0)}
            to {transform: scale(1)}
        }

        /* Change styles for span and cancel button on extra small screens */
        @media screen and (max-width: 300px) {
            span.psw {
                display: block;
                float: none;
            }

            .cancelbtn {
                width: 100%;
            }
        }
    </style>

    <script>
        var checkalertfunction=()=>{
        send_msg({action:"has_alert", username:read_cookie('username')},()=> {
                    $(document).ready(function() {
                     $("#notify").fadeIn(1000).show();
                    });
        },()=>{});
        setTimeout(checkalertfunction, 6000);
    };
    </script>
    <meta charset="UTF-8">
    <title>Navigation bar</title>

    <div id="id01" class="modal2">
        <div class="modal-content2 animate">
            <div class="imgcontainer2">      <span onclick="document.getElementById('id01').style.display='none'" class="close" title="Close Modal">&times;</span>
                <img src="{% static 'images/img_avatar2.png' %}" alt="Avatar" class="avatar">
            </div>

            <div class="container_lg2">
                <label for="uname"><b>Username</b></label>
                <input id="username" type="text" placeholder="Enter Username" name="uname" required>

                <label for="psw"><b>Password</b></label>
                <input id="password" type="password" placeholder="Enter Password" name="psw" required>

                <button id="loginbtn" type="submit">Login</button>
                <label>
                    <input type="checkbox" checked="checked" name="remember"> Remember me
                </label>

            </div>

            <div class="container_lg" style="background-color:#f1f1f1">
                <button type="button" onclick="document.getElementById('id01').style.display='none'" class="cancelbtn">Cancel</button>
                <span class="psw">Forgot <a href="#">password?</a></span>
            </div>
        </div>
    </div>

        <!-- manager navigation bar -->
	 <nav id="manav" class="fh5co-nav" role="navigation" style="background-color: #2D2D2D;visibility: hidden">
		<div class="container">
			<div class="row">
                <script>
                var cookie = read_cookie('permissions');
                switch (cookie) {
                    case  'sys_manager':
                        document.write("<div>\n" +
                            "\t\t\t\t\t<ul>\n" +
                            "\t\t\t\t\t\t<li>\n" +
                            "\t\t\t\t\t\t\t<ul>\n" +
                            "\t\t\t\t\t\t\t\t<li><h5 style=\'color: white\'>User</h5></li>\n" +
                            "\t\t\t\t\t\t\t</ul>\n" +
                            "\t\t\t\t\t\t</li>\n" +
                            "\t\t\t\t\t\t<li><input id='id_remove' placeholder=\'Enter User name\' required></li>\n" +
                            "\t\t\t\t\t\t<li>\n" +
                            "\t\t\t\t\t\t\t<button id=\'removerbtn\' onclick=\"removeUser()\" style=\'padding: 3px 10px;display: inline-block\' type=\'submit\'>Remove</button>\n" +
                            "\t\t\t\t\t\t</li>\n" +
                            "<li style=\'padding-left: 150px\'><h4 style=\'color: white\'>System manager permisions</h4></li>\n" +
                            "\t\t\t\t\t</ul>\n" +
                            "\n" +
                            "\t\t\t\t</div>");
                        break;
                         case  'store_owner':
                        document.write("<div>\n" +
                            "\t\t\t\t\t<ul>\n" +
                            "\t\t\t\t\t\t<li>\n" +
                            "\t\t\t\t\t\t\t<ul>\n" +
                                "<li class=\"has-dropdown\" style=\"color: white\">\n" +
                            "                            <a>Policies</a>\n" +
                            "                            <ul class=\"dropdown\">\n" +
                            "                                <li><a href=\"/store_policy/\">Add Store Policy</a></li>\n" +
                            "                                <li><a href=\"/item_policy/\" id=\"allshopsbtn\">Add Item Policy</a></li>\n" +
                            "                            </ul>\n" +
                            "                        </li>" +
                            "\t\t\t\t\t\t\t\t<li><a href='/add-new-manager/' style=\"color: white\">Add new manager</a></li>\n" +
                            "\t\t\t\t\t\t\t\t<li><a href='/remove-manager/' style=\"color: white\">Remove manager</a></li>\n" +
                            "\t\t\t\t\t\t\t\t<li><a href='/add-new-owner/' style=\"color: white\">Add new Owner</a></li>\n" +
                            "\t\t\t\t\t\t\t\t<li><a href='/remove-owner/' style=\"color: white\">Remove Owner</a></li>\n" +
                                "\t\t\t\t\t\t\t\t<li><a href='/inventory/' style=\"color: white\">Inventory</a></li>\n" +
                            "\t\t\t\t\t\t\t</ul>\n" +
                            "\t\t\t\t\t\t</li>\n" +
                            "<li style=\"padding-left: 150px\"><h4 style=\"color: white\">Store Owner permisions</h4></li>\n" +
                            "\t\t\t\t\t</ul>\n" +
                            "\n" +
                            "\t\t\t\t</div>");
                        break;
                        case  'store_manager':
                            document.write("<div>\n" +
                            "\t\t\t\t\t<ul>\n" +
                            "\t\t\t\t\t\t<li>\n" +
                            "\t\t\t\t\t\t\t<ul>\n" +
                                "<li class=\"has-dropdown\" style=\"color: white\">\n" +
                            "\t\t\t\t\t\t\t\t<li><a href='/add-new-manager/' style=\"color: white\">Add new manager</a></li>\n" +
                            "\t\t\t\t\t\t\t\t<li><a href='/remove-manager/' style=\"color: white\">Remove manager</a></li>\n" +
                                "\t\t\t\t\t\t\t\t<li><a href='/inventory/' style=\"color: white\">Inventory</a></li>\n" +
                            "\t\t\t\t\t\t\t</ul>\n" +
                            "\t\t\t\t\t\t</li>\n" +
                            "<li style=\"padding-left: 150px\"><h4 style=\"color: white\">Store Manager permisions</h4></li>\n" +
                            "\t\t\t\t\t</ul>\n" +
                            "\n" +
                            "\t\t\t\t</div>");
                        break;
                    default:
                        document.write("<h2 style='color:white'>Hello Member</h2>");
                        break;

                }

                function removeUser(){
                    var user = document.getElementById('id_remove').value;
                    if(user != ''){
                        send_msg({action: 'remove_user', user_to_remove: user , username: read_cookie("username")},
                            (message, val)=>{
                                alert(user + " removed");
                            }, onfailure);
                    }
                    else
                        alert("enter user to remove");
                    document.getElementById('id_remove').value = "";
                }
                </script>
			</div>

		</div>
	</nav>


        <script>
            //document.getElementById("manav").style.visibility="visible";
        var nav = document.getElementById("manav");
        var cookie = read_cookie('permissions');
        if (cookie==null || cookie =='false' || cookie==''){
            nav.style.visibility="hidden";
        } else {
            nav.style.visibility="visible";
        }
        </script>
     <!-- end navigation bar -->
<!--notification -->
  <style>
.glyphicon-bell1 {

    font-size:1.5rem;
  }

.notifications1 {
   min-width:320px;
  }

  .notifications-wrapper1 {
     overflow:auto;
      max-height:250px;
      background-color: white;
    }
.menu-title1 {
    color: #ffffff;
    font-size: 13px;
    display: inline-block;
    font-weight: bold;
}

.glyphicon-circle-arrow-right1 {
      margin-left:10px;
   }


 .notification-heading1, .notification-footer1  {
  padding:2px 10px;
       }


.dropdown-menu1.divider {
  margin:5px 0;
  }

.item-title1 {
    font-size: 1.3rem;
    color: #000;
    font-weight: bold;
    margin: 5px 0px;
}

.notifications1 a.content {
    text-decoration: none;
    display: block;
    color:#000;
}
.notification-item1 {
    position: relative;
    padding: 10px;
    padding-left: 70px;
    padding-bottom: 0px;
}
.notification-item1 img {
    position: absolute;
    top: 7px;
    left: 10px;
    width: 50px;
    height: 50px;
    border-radius: 50px;
}
.dropdown-menu1 .divider {
    height: 1px;
    margin: 5px 0;
    overflow: hidden;
    background-color: #e5e5e5;
}
ul.dropdown-menu1.notifications1.notifications-wrapper1 a.content {
    padding: 0px !important;
    background: rgba(0, 0, 0, 0.04);
    border-bottom: 1px solid #d1d1d1;
}
ul.dropdown-menu1.notifications1 .notifications-wrapper1 a.content:hover {
    color: #000;
    background: rgba(0, 0, 0, 0.1);
}
.login-nav ul.nav.navbar-nav.navbar-right li a {
    display: block;
}
.notification-heading1 {
    background: #000;}
.notifications1 a.content {
    text-decoration: none;
    display: block;
    padding: 3px 10px;
}
ul.dropdown-menu1.notifications1 {
    padding: 0px;
}

.dropdown1{
    display: none;mix-width: 25%;
    top:50px;
    min-width: 255px;
    list-style:square;
    overflow: scroll;
    z-index: 1;
    position: fixed;
}

</style>
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet">
<script>
function CustomAlert(){
    this.render = function(dialog){
        $("#box").fadeIn(1000).show()
        document.getElementById('mes_list').innerHTML='<a class="content" href="#">\n' +
            '       <div class="notification-item1">\n' +
            '        <h4 class="item-title1">There is no any notification</h4>\n' +
            '      </div>\n' +
            '    </a>';
        send_msg({action:'get_notification',username:read_cookie('username')},(res,val)=>{
            var messages = val['messages'];
            var mes = '';
            messages.forEach((message)=>{
                mes += '<a class="content" href="#">\n' +
            '       <div class="notification-item1">\n' +
            '       <img src="http://www.leapcms.com/images/100pixels1.gif">\n' +
            '        <h4 class="item-title1">New message from : '+message['sender']+'<small> '+message['time']+'</small></h4>\n' +
            '        <p class="item-info1">'+message['message']+'</p>\n' +
            '      </div>\n' +
            '    </a>';
            });
            document.getElementById('mes_list').innerHTML=mes;
        },()=>{
            document.getElementById('mes_list').innerHTML='<a class="content" href="#">\n' +
            '       <div class="notification-item1">\n' +
            '        <h1>There is no any notification</h1>\n' +
            '      </div>\n' +
            '    </a>';
        });

        $("#notify").hide();
    }
	this.ok = function(){
		document.getElementById('box').style.display = "none";
	}
}
/*
    document.getElementById("clearbtn").onclick(function (event) {
       send_msg({action:'clear_notification',username:''},(res,val)=>{
        $("#notify").show();
       },()=>{});
    });*/

var Alert = new CustomAlert();
</script>

    <li class="dropdown1" id="box">
  <a id="dLabel" role="button" data-toggle="dropdown" data-target="#" href="/page.html">
  </a>

  <br class="notifications1" role="menu" aria-labelledby="dLabel">
    <div class="notification-heading1"><h4 class="menu-title1">Notifications</h4><span style="cursor: pointer;" onclick="$('#box').hide()" class="menu-title1 pull-right">&#x274C;</span>
    </div>
   <div id="mes_list" class="notifications-wrapper1">


   </div>
      <button id="clearbtn" type="button" class="btn bg-danger fs-it-btn" onclick="">
		    <i class="fa icon-trash" aria-hidden="true"></i>
		    <span class="fs-it-btn-vertical-line"></span>
		    Clear All</button>
  </ul>
  </li>

    <nav class="fh5co-nav" role="navigation">
        <div class="container">
            <div class="row">
                <div class="col-md-3 col-xs-2">
                    <div id="fh5co-logo"><a href="/">Shop.</a></div>
                </div>
                <div class="col-md-6 col-xs-6 text-center menu-1">
                    <ul>
                        <li class="has-dropdown">
                            <a>Shop</a>
                            <ul class="dropdown">
                                <li><a href="/shop_all/">All Products</a></li>
                                <li><a href="/all_shops/" id="allshopsbtn">All Shops</a></li>
                            </ul>
                        </li>
                        <li class="has-dropdown">
                            <a>Services</a>
                            <ul class="dropdown">
                                <li><a href="/create_store">Add Store</a></li>
                                <li><a href="#">eCommerce</a></li>
                                <li><a href="#">Branding</a></li>
                                <li><a href="#">API</a></li>
                            </ul>
                        </li>
                        <li><a href="/about/">About</a></li>
                        <li><a href="/contact/">Contact</a></li>
                    </ul>
                </div>
                <div class="col-md-3 col-xs-4 text-right hidden-xs menu-2">
                    <ul>
                        <li><a  class="notification">
                        <span onclick="Alert.render()" id="inbox" style="cursor: pointer;">Inbox</span>
                        <span class="badge" id="notify" >!</span>
                        </a></li>
                        <li > <a id="signup" href="/signup/" class="button"><i class="glyphicon-info-sign"></i>signup</a></li>
                        <li class="login">
                            <script>
                                var cookie = read_cookie('login');
                                if (cookie==null || cookie =='false' || cookie==''){
                                    document.write("<a id='login' style='cursor: pointer;'><i class='icon-login'></i> login</a>");
                                } else {
                                    setTimeout(checkalertfunction, 6000);
                                    document.write("<a id='logout' style='cursor: pointer'><i class='icon-log-out'></i> logout</a>");
                                }
                            </script></li>
                        <li id="num_in_cart" class="shopping-cart"><a href="/shopping-cart/" class="cart"><span id="wr"><small id="size">
                            <script src="http://code.jquery.com/jquery-latest.js"></script>
                            <script>
                                //alert(read_cookie('cart'));
                                var a =read_cookie('cart');
                                var size = read_cookie('cart')==''? 0 : read_cookie('cart');
                                document.write(size);
                            </script></small><i class="icon-shopping-cart"></i></span></a></li>

                        <li class="search">
                            <div class="input-group">
                                <input type="text" placeholder="Search.." id="search">
                                <span class="input-group-btn">
						        <button class="btn btn-primary" type="button" id="btnsearch" href="/search_items"><i class="icon-search"></i></button>
						      </span>
                            </div>
                        </li>
                    </ul>
                </div>
            </div>

        </div>
    </nav>

</head>

{% block head2 %} {% endblock %}

<body>

{% block body %} {% endblock %}

<footer id="fh5co-footer" role="contentinfo">
    <div class="container">
        <div class="row row-pb-md">
            <div class="col-md-4 fh5co-widget">
                <h3>Shop.</h3>
                <p>Facilis ipsum reprehenderit nemo molestias. Aut cum mollitia reprehenderit. Eos cumque dicta adipisci architecto culpa amet.</p>
            </div>
            <div class="col-md-2 col-sm-4 col-xs-6 col-md-push-1">
                <ul class="fh5co-footer-links">
                    <li><a href="#">About</a></li>
                    <li><a href="#">Help</a></li>
                    <li><a href="#">Contact</a></li>
                    <li><a href="#">Terms</a></li>
                    <li><a href="#">Meetups</a></li>
                </ul>
            </div>

            <div class="col-md-2 col-sm-4 col-xs-6 col-md-push-1">
                <ul class="fh5co-footer-links">
                    <li><a href="#">Shop</a></li>
                    <li><a href="#">Privacy</a></li>
                    <li><a href="#">Testimonials</a></li>
                    <li><a href="#">Handbook</a></li>
                    <li><a href="#">Held Desk</a></li>
                </ul>
            </div>

            <div class="col-md-2 col-sm-4 col-xs-6 col-md-push-1">
                <ul class="fh5co-footer-links">
                    <li><a href="#">Find Designers</a></li>
                    <li><a href="#">Find Developers</a></li>
                    <li><a href="#">Teams</a></li>
                    <li><a href="#">Advertise</a></li>
                    <li><a href="#">API</a></li>
                </ul>
            </div>
        </div>

        <div class="row copyright">
            <div class="col-md-12 text-center">
                <p>
                    <small class="block">&copy; 2016 Free HTML5. All Rights Reserved.</small>
                    <small class="block">Designed by <a href="http://freehtml5.co/" target="_blank">FreeHTML5.co</a> Demo Images: <a href="http://blog.gessato.com/" target="_blank">Gessato</a> &amp; <a href="http://unsplash.co/" target="_blank">Unsplash</a></small>
                </p>
                <p>
                <ul class="fh5co-social-icons">
                    <li><a href="#"><i class="icon-twitter"></i></a></li>
                    <li><a href="#"><i class="icon-facebook"></i></a></li>
                    <li><a href="#"><i class="icon-linkedin"></i></a></li>
                    <li><a href="#"><i class="icon-dribbble"></i></a></li>
                </ul>
                </p>
            </div>
        </div>

    </div>
</footer>

<script>
    checkExpire();
    // Get the modal
    var modal = document.getElementById('id01');
    // When the user clicks anywhere outside of the modal, close it
    var onsuccess =  (res) =>{
        alert(res);
        window.location.href = '/';
        document.cookie = "login = true;domain=;path=/";
        window.location.href = '/';
    }
    var btnsearch = document.getElementById('btnsearch');
    btnsearch.onclick = function(event) {
        var keyword = document.getElementById('search').value;
        window.location.href = '/search_items/';
        write_cookie('keyword', keyword);

    }
    window.onclick = function(event) {
        if (event.target == modal) {
            modal.style.display = "none";
        }
    }
    var logout_onsuccess =  (res) =>{
        alert(res);
        document.cookie = "login = false;domain=;path=/";
        document.cookie = "permissions = false;domain=;path=/";
        window.location.href = '/';
    };
    var logout_onfailure =  (res) =>{
        alert(res);
    };
    if(document.getElementById('login')!=undefined){
        document.getElementById('login').onclick = function (event) {
            document.getElementById('id01').style.display='block';
        }
    }
    else{
        document.getElementById('logout').onclick = function (event) {
            var username = read_cookie('username');
            send_msg({action:'logout', username: username},logout_onsuccess, logout_onfailure);
        };
    }


    var btn = document.getElementById('loginbtn');
    var onsuccess =  (res,per) =>{
        alert(res);
        window.location.href = '/';
        document.cookie = "login = true;domain=;path=/";
        document.cookie = "permissions = "+per+";domain=;path=/"; // sys_manager , guest , user , store_owner , store_manager
        window.location.href = '/';
    };

    var onfailure = (res) =>{
        alert(res);
        write_cookie('username','');
        //window.location.href = '/';
    }
    btn.onclick = function (event){
        var username = document.getElementById('username').value;
        var psw = document.getElementById('password').value;
        if(username == '') {
            alert('Username field is empty !');
            return;
        }

        if(psw==''){
            alert('Password field is empty ! ');
            return;
        }
        write_cookie('username',username);
        send_msg({action:'login', username: username, password: psw},onsuccess, onfailure);

    }
    var user = read_cookie('username');
    var ipadd='';
    if (user=="" ){
    $.getJSON('http://www.geoplugin.net/json.gp?jsoncallback=?', function(data) {
    console.log(JSON.stringify(data, null, 2));
    ipadd = data['geoplugin_request'];
    write_cookie('username',ipadd);
    //initclient();
    send_msg({action:'new_guest',username:ipadd},(res)=>{alert(res),()=>{}})
    });
    }
</script>

<!-- jQuery -->
<script src="{% static 'js/jquery.min.js' %}"></script>
<!-- jQuery Easing -->
<script src="{% static 'js/jquery.easing.1.3.js' %}"></script>
<!-- Bootstrap -->
<script src="{% static 'js/bootstrap.min.js' %}"></script>
<!-- Waypoints -->
<script src="{% static 'js/jquery.waypoints.min.js' %}"></script>
<!-- Carousel -->
<script src="{% static 'js/owl.carousel.min.js' %}"></script>
<!-- countTo -->
<script src="{% static 'js/jquery.countTo.js' %}"></script>
<!-- Flexslider -->
<script src="{% static 'js/jquery.flexslider-min.js' %}"></script>
<!-- Main -->
<script src="{% static 'js/main.js' %}"></script>
<script src="{% static 'js/client.js' %}"></script>

</body>
</html>